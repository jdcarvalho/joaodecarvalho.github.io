<!DOCTYPE html> <html lang=" en "><head> <meta charset="utf-8" /> <title> Proof of Concept: 2FA in Django with TOTP - #jdcarvalho </title> <meta http-equip="X-UA-Compatible" content="IE=edge" /> <meta name="viewport" content="width=device-width, initial-scale=1" /> <meta name="keywords" content="Proof of Concept: 2FA in Django with TOTP, #jdcarvalho, Python, Django, 2FA,"/> <link rel="alternate" type="application/rss+xml" title="RSS" href="/feed.xml" /> <meta content="" property="fb:app_id" /> <meta content="#jdcarvalho" property="og:site_name" /> <meta content="Proof of Concept: 2FA in Django with TOTP" property="og:title" /> <meta content="article" property="og:type" /> <meta content="devlopr-jekyll is a beautiful Jekyll Theme Built For Developers, which is optimized for speed and readability." property="og:description" /> <meta content="http://localhost:4000/python/django/2fa/2025/06/25/poc-django-2fa-implementation/" property="og:url" /> <meta content="2025-06-25T11:07:00-03:00" property="article:published_time" /> <meta content="http://localhost:4000/about/" property="article:author" /> <meta content="http://localhost:4000/assets/img/posts/poc-django-2fa-implementation.png" property="og:image" /> <meta content="Python" property="article:section" /> <!-- Twitter Cards --> <meta name="twitter:card" content="summary" /> <meta name="twitter:site" content="@" /> <meta name="twitter:creator" content="@" /> <meta name="twitter:title" content="Proof of Concept: 2FA in Django with TOTP" /> <meta name="twitter:url" content="http://localhost:4000/python/django/2fa/2025/06/25/poc-django-2fa-implementation/" /> <meta name="twitter:description" content="devlopr-jekyll is a beautiful Jekyll Theme Built For Developers, which is optimized for speed and readability." /> <link rel="stylesheet" href="http://localhost:4000/assets/css/main.css" /> <!-- <link rel="stylesheet" href="http://localhost:4000/assets/css/custom-style.css" /> --> <link rel="stylesheet" href="http://localhost:4000/assets/bower_components/lightgallery/dist/css/lightgallery.min.css" /> <link rel="stylesheet" href="https://cdn.snipcart.com/themes/v3.0.0-beta.3/default/snipcart.css" /> <link rel="stylesheet" href="http://localhost:4000/assets/bower_components/bootstrap/dist/css/bootstrap.min.css" /> <link rel="stylesheet" href="http://localhost:4000/assets/bower_components/font-awesome/web-fonts-with-css/css/fontawesome-all.min.css" /> <link rel="stylesheet" href="http://localhost:4000/assets/bower_components/icono/dist/icono.min.css" /> <!-- Fonts--> <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet" /> <!-- Favicon --> <link rel="icon" href="http://localhost:4000/assets/img/favicon.ico" type="image/gif" sizes="16x16" /> <script> var base_url = 'http://localhost:4000' ; </script> <!-- Jquery --> <script src="https://code.jquery.com/jquery-3.4.1.min.js" integrity="sha384-vk5WoKIaW/vJyUAd9n/wmopsmNhiy+L2Z+SBxGYnUkunIxVxAv/UtMOhba/xskxh" crossorigin="anonymous" ></script> <!-- Swiper CSS --> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css"/> <!-- Swiper JS --> <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script> <!-- <script src="http://localhost:4000/assets/bower_components/jquery/dist/jquery.min.js"></script> --> <script src="http://localhost:4000/assets/js/mode-switcher.js"></script> <script src="http://localhost:4000/assets/bower_components/jquery.easing/jquery.easing.min.js"></script> <script src="http://localhost:4000/assets/bower_components/bootstrap/dist/js/bootstrap.bundle.min.js"></script> <script src="http://localhost:4000/assets/bower_components/jquery-mousewheel/jquery.mousewheel.min.js"></script> <script src="http://localhost:4000/assets/bower_components/ghosthunter/dist/jquery.ghostHunter.min.js"></script> <script src="http://localhost:4000/assets/bower_components/lightgallery/dist/js/lightgallery-all.min.js"></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/picturefill/3.0.2/picturefill.min.js"></script> <script src="http://localhost:4000/assets/bower_components/imagesloaded/imagesloaded.pkgd.min.js"></script> <script src="http://localhost:4000/assets/bower_components/nanobar/nanobar.min.js"></script> <script src="http://localhost:4000/assets/bower_components/typewrite/dist/typewrite.min.js"></script> <script src="http://localhost:4000/assets/js/search.js"></script> <script src="http://localhost:4000/assets/js/on-scroll-progress.js"></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.20.1/moment.min.js"></script> <script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script> <!-- for Mathjax support --> <!-- Github Button --> <script async defer src="https://buttons.github.io/buttons.js"></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous" ></script> <!--[if lt IE 7]> <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]--> <!--[if IE 7]> <html class="no-js lt-ie9 lt-ie8"> <![endif]--> <!--[if IE 8]> <html class="no-js lt-ie9"> <![endif]--> <!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]--> </head> <body> <nav class="navbar navbar-expand-lg fixed-top navbar-dark" id="topNav"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation" > <span class="icono-hamburger" id="navbar-hamburger"> </span> </button> <a class="navbar-brand" href="/">#jdcarvalho</a> <div class="collapse navbar-collapse" id="navbarNav"> <ul class="navbar-nav"> <li class="nav-item"> <a class="nav-link" href="http://localhost:4000/" >Home</a > </li> <li class="nav-item"> <a class="nav-link" href="http://localhost:4000/about" >About</a > </li> <li class="nav-item"> <a class="nav-link" href="http://localhost:4000/blog" >Blog</a > </li> </ul> </div> <ul class="nav justify-content-end"> <li class="nav-item"> <input class="nav-link switch theme-toggle" type="checkbox" name="checkbox" /> </li> </ul> </nav> <div id="progress-bar"></div> <!-- Search Form --> <div class="search-form-container"> <form class="search-form"> <fieldset class="search-form__fieldset"> <div class="row"> <div class="col-lg-8 offset-md-2"> <input class="search-form__field" placeholder="Type to Search..." autofocus> <input class="search-form__submit" type="submit" value="search"> </div> </div> </fieldset> </form> <div class="row"> <div class="col-lg-8 offset-md-2 search-results"> <div class="card search-results"></div> </div> </div> <div class="close-search-button search-form-container__close"> <i class="fa fa-times icon"></i> </div> </div><div class="main-container"> <div class="row justify-content-center" id="blog-post-container"> <div class="col-lg-10"><article class="card" itemscope itemtype="http://schema.org/BlogPosting"> <div class="card-header"> <h1 class="post-title" itemprop="name headline">Proof of Concept: 2FA in Django with TOTP</h1> <h4 class="post-meta"></h4> <p class="post-summary"> Posted by : <span itemprop="author" itemscope itemtype="http://schema.org/Person"> <span itemprop="name"><a href="http://localhost:4000/blog/authors/jdcarvalho">jdcarvalho</a></span> </span > on <time datetime="2025-06-25 11:07:00 -0300" itemprop="datePublished" >Jun 25, 2025</time > </p> <span class="disqus-comment-count" data-disqus-identifier="/python/django/2fa/2025/06/25/poc-django-2fa-implementation/" ></span> <div class="post-categories"> Category : <a href="/blog/categories/Python" >Python</a > &nbsp; <a href="/blog/categories/Django" >Django</a > &nbsp; <a href="/blog/categories/2FA" >2FA</a > </div> </div> <div class="card-body" itemprop="articleBody"> <img class="card-img-top" src="http://localhost:4000/assets/img/posts/poc-django-2fa-implementation.png" alt="" /> <br /> <br /> <h1 id="proof-of-concept-2fa-in-django-with-totp">Proof of Concept: 2FA in Django with TOTP</h1> <hr /> <h3 id="-introduction">üîí Introduction</h3> <p><a href="https://github.com/jdcarvalho/otpauth">The otpauth repository</a> is a proof of concept (POC) that demonstrates how to integrate Two‚ÄëFactor Authentication (2FA) using Time‚Äëbased One‚ÄëTime Passwords (TOTP) into a Django application.</p> <p>It leverages the <code class="language-plaintext highlighter-rouge">pyotp</code> library to generate and verify time-bound OTPs, providing an extra layer of security on top of the traditional username/password login flow. The project also customizes the Django admin interface to manage 2FA settings, making it easy to integrate into existing Django apps ‚Äî especially admin panels or internal tools that need additional protection.</p> <hr /> <h3 id="-project-structure">üìÅ Project Structure</h3> <p>The repository includes the following components:</p> <ul> <li><code class="language-plaintext highlighter-rouge">otpauth/</code>: Django app containing models, views, forms, and core logic for OTP integration.</li> <li><code class="language-plaintext highlighter-rouge">custom_admin/</code>: Admin customizations to manage OTP settings and enable 2FA per user.</li> <li><code class="language-plaintext highlighter-rouge">templates/</code>: HTML pages for OTP enrollment, QR code display, and verification.</li> <li><code class="language-plaintext highlighter-rouge">manage.py</code> &amp; <code class="language-plaintext highlighter-rouge">requirements.txt</code>: Typical Django project files and dependencies.</li> </ul> <hr /> <h3 id="-setup-instructions">‚úÖ Setup Instructions</h3> <p>To run the POC locally:</p> <ol> <li>Create a virtual environment (Python 3.x recommended)</li> <li> <p>Install dependencies:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code> pip <span class="nb">install</span> <span class="nt">-r</span> requirements.txt
</code></pre></div> </div> </li> <li> <p>Run migrations and create a superuser:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code> ./manage.py makemigrations
 ./manage.py migrate
 ./manage.py createsuperuser
</code></pre></div> </div> </li> <li> <p>Start the development server:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code> ./manage.py runserver
</code></pre></div> </div> </li> <li>Access Django Admin at <code class="language-plaintext highlighter-rouge">http://127.0.0.1:8000/admin/</code>, enable 2FA for a user, and log in to test OTP flows.</li> </ol> <hr /> <h3 id="-core-components">üß© Core Components</h3> <ul> <li> <p><strong>pyotp Integration</strong>: The <code class="language-plaintext highlighter-rouge">pyotp</code> library is used to generate and validate TOTP codes using a shared secret between the server and the user‚Äôs authenticator app.</p> </li> <li> <p><strong>Secret Generation &amp; Storage</strong>:</p> <ul> <li>A random base32 secret is generated using <code class="language-plaintext highlighter-rouge">pyotp.random_base32()</code></li> <li>The secret is securely stored in the user profile or a dedicated OTP model</li> <li>A QR code is generated and rendered via templates to simplify enrollment with apps like Google Authenticator or Authy</li> </ul> </li> </ul> <hr /> <h3 id="-flow-diagram-summary">üìà Flow Diagram Summary</h3> <p>The diagram below illustrates the 2FA flow, from secret generation to OTP verification during login:</p> <p><img src="/assets/img/posts/otp-flow.png" alt="OTP Flow" /></p> <hr /> <h3 id="-next-steps-optional-enhancements">üîß Next Steps (Optional Enhancements)</h3> <p>This POC can be extended with the following improvements for real-world use:</p> <ul> <li>Add backup codes for recovery</li> <li>Enforce OTP validation across all login endpoints using middleware</li> <li>Integrate support for WebAuthn or hardware-based tokens</li> <li>Secure the QR code endpoint with permissions or CSRF protection</li> </ul> <hr /> <h3 id="Ô∏è-disclaimer">üõ°Ô∏è Disclaimer</h3> <p>This implementation is intended as a learning resource and starting point. Additional hardening is required before deploying it in production environments, such as rate-limiting login attempts and encrypting stored secrets.</p> <br /><!-- Load Facebook SDK for JavaScript --> <div id="fb-root"></div> <script> (function(d, s, id) { var js, fjs = d.getElementsByTagName(s)[0]; if (d.getElementById(id)) return; js = d.createElement(s); js.id = id; js.src = "https://connect.facebook.net/en_US/sdk.js#xfbml=1&version=v3.0"; fjs.parentNode.insertBefore(js, fjs); })(document, "script", "facebook-jssdk"); </script> <script async src="https://platform.twitter.com/widgets.js" charset="utf-8" ></script> <div class="share-page"> <p class="share-text">Share this on &rarr;</p> <a href="https://twitter.com/share?ref_src=twsrc%5Etfw" class="twitter-share-button" data-size="large" data-show-count="false" style="margin-top:5px;" >Tweet</a > <a class="fb-share-button" data-href="http://localhost:4000/python/django/2fa/2025/06/25/poc-django-2fa-implementation/" data-size="large" data-layout="button" >Share</a> </div><!-- Author box --> <div class="card"> <div class="card-header"> About Jo√£o de Carvalho </div> <div class="card-body"> <div class="row"> <div class="col-md-4"> <img class="author-profile-img" src="http://localhost:4000/assets/img/authors/jdcarvalho.png" alt="Jo√£o de Carvalho" /> </div> <div class="col-md-6"> <p class="author_bio">Experienced Web Software Developer with over 10 years designing, building, and scaling SaaS platforms for education. Additionally, brings 9 years of solid experience in developing solutions for retail, accounting, and business intelligence, combining deep technical skills with strong business understanding. Passionate about creating reliable, scalable, and user-centered software.</p> <p>Email : </p> <p>Website : https://joaodecarvalho.com</p> <p class="profile-links"> <a class="social-link" href="https://github.com/jdcarvalho" target="_blank"><i class="fab fa-github fa-fw"></i></a> <a class="social-link" href="https://www.linkedin.com/in/jdiascarvalho" target="_blank"><i class="fab fa-linkedin fa-fw"></i></a> <a class="social-link" href="https://instagram.com/jdiascarvalho" target="_blank"><i class="fab fa-instagram fa-fw"></i></a> <a class="social-link" href="https://t.me/jdiascarvalho" target="_blank"><i class="fab fa-telegram fa-fw"></i></a> </p> </div> </div> </div> </div> </div> <div class="comments"> <script src="https://giscus.app/client.js" data-repo="sujaykundu777/devlopr-jekyll" data-repo-id="MDEwOlJlcG9zaXRvcnkxMzk1NzQ1NTY=" data-category="General" data-category-id="MDE4OkRpc2N1c3Npb25DYXRlZ29yeTMyODk4MTky" data-mapping="pathname" data-strict="0" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="bottom" data-theme="preferred_color_scheme" data-lang="en" crossorigin="anonymous" async> </script> </div><!-- Incomment incase you want to use Disqus <div id="disqus_thread"></div> --> </article> <script> var disqus_config = function () { this.page.url = "http://localhost:4000/python/django/2fa/2025/06/25/poc-django-2fa-implementation/"; /* Replace PAGE_URL with your page's canonical URL variable */ this.page.identifier = "/python/django/2fa/2025/06/25/poc-django-2fa-implementation"; /* Replace PAGE_IDENTIFIER with your page's unique identifier variable */ }; (function () { /* DON'T EDIT BELOW THIS LINE */ var d = document, s = d.createElement('script'); s.src = 'https://.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); </script> <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a> </noscript></div> </div> <div class="row"> <div class="col-md-4"> <div class="card"> <div class="card-header">About Jo√£o de Carvalho</div> <div class="card-body"> <p class="author_bio">Experienced Web Software Developer with over 10 years designing, building, and scaling SaaS platforms for education. Additionally, brings 9 years of solid experience in developing solutions for retail, accounting, and business intelligence, combining deep technical skills with strong business understanding. Passionate about creating reliable, scalable, and user-centered software.</p><!--&lt;!&ndash; Place this tag where you want the github button to render. &ndash;&gt;--> <!--<a class="github-button" href="https://github.com/sujaykundu777/devlopr-jekyll" data-color-scheme="no-preference: dark; light: dark; dark: dark;" data-icon="octicon-star" data-size="large" data-show-count="true" aria-label="Star sujaykundu777/devlopr-jekyll on GitHub">Star</a>--> </div> </div> </div> <div class="col-md-4"> <div class="card"> <div class="card-header">Categories</div> <div class="card-body text-dark"> <div id="#Python"></div> <li class="tag-head"> <a href="/blog/categories/Python">Python</a> </li> <a name="Python"></a> <div id="#Django"></div> <li class="tag-head"> <a href="/blog/categories/Django">Django</a> </li> <a name="Django"></a> <div id="#2FA"></div> <li class="tag-head"> <a href="/blog/categories/2FA">2FA</a> </li> <a name="2FA"></a> </div> </div> </div> <div class="col-md-4"> <div class="card"> <div class="card-header">Useful Links</div> <div class="card-body text-dark"> <li> <a href="http://localhost:4000/">Home</a> </li> <li> <a href="http://localhost:4000/about">About</a> </li> <li> <a href="http://localhost:4000/blog">Blog</a> </li> </div> </div> </div> </div> </div> <div class="col-lg-12" id="newsletter_footer"></div><footer> <p> Powered by <a href="https://github.com/sujaykundu777/devlopr-jekyll">devlopr theme jekyll</a>. Hosted with <a href="https://pages.github.com">Github Pages</a></p> </footer> <script> var options = { classname: 'progressline', id: 'my-id' }; var nanobar = new Nanobar( options ); nanobar.go( 30 ); nanobar.go( 76 ); nanobar.go(100); </script> <div hidden id="snipcart" data-api-key="Y2I1NTAyNWYtMTNkMy00ODg0LWE4NDItNTZhYzUxNzJkZTI5NjM3MDI4NTUzNzYyMjQ4NzU0"></div> <script src="https://cdn.snipcart.com/themes/v3.0.0-beta.3/default/snipcart.js" defer></script> <script> if (window.netlifyIdentity) { window.netlifyIdentity.on("init", user => { if (!user) { window.netlifyIdentity.on("login", () => { document.location.href = "/admin/"; }); } }); } </script> </body> </html>
